 <#include "/common/head.html"/>


<div class="easyui-panel updatePage"
	data-options="fit:true,border:false">
	<form id="ff" class="easyui-form" method="post">
		<table class="table1">
			<tr>
				<th><span>昵称：</span></th>
				<td>
					<div class="wrap_input">
						<input disabled class="easyui-textbox" type="text" name="nickName"
							id="nickName" value="${model.nickName!''}"
							data-options="fit: true,required:true"></input>
					</div>
				</td>

			</tr>
			<tr>
				<th><span>公司：</span></th>
				<td>
					<div class="wrap_input">

                        <input id="company" name="company" data-options="panelHeight:'auto'"
                               class="easyui-combobox" style="width:80%">

					</div>
				</td>

			</tr>
		</table>
	</form>
</div>
<script>
top.window.subPage.save = save;
function save() {
	if($("#zcurdHeadTable").form('validate')) {
		$.post("../company/updateAdminId", getParam(), function(data) {
			top.window.closeWindow();
			// top.window.subPage.loadCurrDatagrid();
		});
	}
}
$(function () {
    $.ajax({
        url : "../company/listData",
        type : "POST",
        async : true,// 设置同步方式，false为同步
        success : function(res) {
            $('#company').combobox({
                data : res.rows,
                multiple:true, //支持多选
                valueField : 'id',
                textField : 'company_name'
            });
        }
    })

    $.ajax({
        url : "../company/getCompanyByAgentId",
        type : "POST",
        data : {
            "userId":${model.id}
        },
        success : function(res) {
          var data = res.companyList;
          var companyIds="";
          for(var i=0;i<data.length;i++){
              companyIds+=data[i].id+",";
          }

            $('#company').combobox('setValues',companyIds.substring(0,companyIds.length-1));
        }
    })




})
function getParam() {

    var companyIds = $('#company').combobox('getValues');
	var param = {
	    "id": companyIds.join(","),
        "admin_id": ${model.id}
	}
	for(key in param) {
		if(!param[key]) {
			delete param[key];
		}
	}
	return param;
}

//扩展js
</script>
<#include "/common/foot.html"/>
