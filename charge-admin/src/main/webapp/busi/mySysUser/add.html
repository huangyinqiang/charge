
<#include "/common/head.html"/>


 <div class="easyui-panel addPage" data-options="fit:true,border:false,novalidate:true">
    <form class="easyui-form" id="ff" method="post" data-options="novalidate:true">
        <table class="table1">
            <tr>
           		<th><span>用户名:</span></th>
               	<td >
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="user_name" id="user_name" value="" data-options="fit: true,required:true"  style="width: 130px;"></input></div>
           		</td>
            <tr>
           		<th><span>密码:</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="password" id="password" value="" data-options="fit: true,required:true"  style="width: 130px;"></input></div>
           		</td>
            </tr>
            <tr>
           		<th><span>角色:</span></th>
               	<td>
               		<div class="wrap_input">
						<input id="roles" class="easyui-combobox" name="roles"
							   data-options="valueField:'id',textField:'name',url:'getRoleList',multiple:true,"  style="width: 130px;"/>
					</div>
           		</td>
            </tr>
        </table>
    </form>
</div>
<script>

        top.window.subPage.save = save;


        function save() {
            if($("#ff").form('enableValidation').form('validate')) {
                $.post("add", getParam(), function(data) {
                    top.window.closeWindow();
                    top.window.subPage.loadCurrDatagrid();
                });
            }
        }

        function add() {
            top.window.subPage.loadCurrDatagrid = function() {
                showMsg("增加成功");
                datagrid.datagrid("load");
            }
            top.openWindow("微信充值-增加", getCurrUrl("addPage") + "?" + $.param(initPara), {size: '600x400'});
        }


function getParam() {
    var roles ="";
    $("input[name='roles']").each(function(){
        roles+=$(this).val();
        roles+=",";
    });
    roles=roles.substr(0,roles.length-1);

	var param = {
       	    "model.user_name": $(":input[name='user_name']").val(),
       	    "model.password": $(":input[name='password']").val(),
       	    "model.roles": roles,
	}
	for(key in param) {
		if(!param[key]) {
			delete param[key];
		}
	}
	return param;
}

//扩展js
</script>
<#include "/common/foot.html"/>
